<h2>Visits</h2>
<button (click)="activateForm()">+Add New Visit</button>

@if (AddBtnPressed) {
  <form [formGroup]="addVisitForm" (ngSubmit)="onSubmit()" id="addVisitForm">
    <div>
      <label for="visitID">Visit ID</label><br />
      <input formControlName="visitID" type="number" id="visitID" name="visitID" />
    </div>

    <div>
      <label for="visitType">Visit Type</label><br />
      <input formControlName="visitType" type="text" id="visitType" name="visitType"
             placeholder="Emergency / Follow-Up / Consultation" />
    </div>

    <div>
      <label for="visitTypeID">Visit Type ID</label><br />
      <input formControlName="visitTypeID" type="number" id="visitTypeID" name="visitTypeID" />
    </div>

    <div>
      <label for="visitDuration">Visit Duration (min)</label><br />
      <input formControlName="visitDuration" type="number" id="visitDuration" name="visitDuration" />
    </div>

    <div>
      <label for="visitDate">Visit Date/Time</label><br />
      <input formControlName="visitDate" type="datetime-local" id="visitDate" name="visitDate" />
    </div>

    <div>
      <label for="visitFee">Visit Fee</label><br />
      <input formControlName="visitFee" type="number" id="visitFee" name="visitFee" />
    </div>

    <div>
      <button type="submit" [disabled]="addVisitForm.invalid || addVisitForm.pending">Add Visit</button>
      <button type="button" (click)="deactivateForm()">cancel</button>
    </div>
  </form>
}

@if (EditBtnPressed) {
  <form [formGroup]="editVisitForm" (ngSubmit)="onEdit()" id="editVisitForm">
    <div>
      <label for="e_visitID">Visit ID</label><br />
      <input formControlName="visitID" type="number" id="e_visitID" name="visitID" />
    </div>

    <div>
      <label for="e_visitType">Visit Type</label><br />
      <input formControlName="visitType" type="text" id="e_visitType" name="visitType" />
    </div>

    <div>
      <label for="e_visitTypeID">Visit Type ID</label><br />
      <input formControlName="visitTypeID" type="number" id="e_visitTypeID" name="visitTypeID" />
    </div>

    <div>
      <label for="e_visitDuration">Visit Duration (min)</label><br />
      <input formControlName="visitDuration" type="number" id="e_visitDuration" name="visitDuration" />
    </div>

    <div>
      <label for="e_visitDate">Visit Date/Time</label><br />
      <input formControlName="visitDate" type="datetime-local" id="e_visitDate" name="visitDate" />
    </div>

    <div>
      <label for="e_visitFee">Visit Fee</label><br />
      <input formControlName="visitFee" type="number" id="e_visitFee" name="visitFee" />
    </div>

    <div>
      <button type="submit" [disabled]="editVisitForm.invalid || editVisitForm.pending">Edit Visit</button>
      <button type="button" (click)="deactivateEditForm()">cancel</button>
    </div>
  </form>
}

<table class="visits-table">
  <thead>
    <tr>
      <th>Visit ID</th>
      <th>Visit Type</th>
      <th>Visit Type ID</th>
      <th>Visit Duration</th>
      <th>Visit Date</th>
      <th>Visit Fee</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    @for (visit of AllVisits; track visit) {
      <tr>
        <td>{{ visit.visitID }}</td>
        <td>{{ visit.visitType }}</td>
        <td>{{ visit.visitTypeID }}</td>
        <td>{{ visit.visitDuration }}</td>
        <td>{{ displayDate(visit.visitDate) }}</td>
        <td>{{ visit.visitFee }}</td>
        <td class="actions">
          <button type="button" class="btn btn-edit" (click)="activateEditForm(visit)">Edit</button>
          <button type="button" class="btn btn-delete" (click)="deleteAction(visit.visitID)">Delete</button>
        </td>
      </tr>
    }
  </tbody>
</table>
